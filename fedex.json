{
  "info": {
    "name": "FedEx Chile Domestic API (TEST)",
    "_postman_id": "fedex-chile-domestic-test",
    "description": "Colección de pruebas para FedEx Chile Domestic API (WS Beta)",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "variable": [
    {
      "key": "access_token",
      "value": ""
    },
    {
      "key": "masterTrackingNumber",
      "value": ""
    }
  ],
  "item": [
    {
      "name": "OAuth Token",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "// Guardar access_token automáticamente",
              "if (pm.response.code === 200) {",
              "  var jsonData = pm.response.json();",
              "  if (jsonData.access_token) {",
              "    pm.collectionVariables.set(\"access_token\", jsonData.access_token);",
              "    console.log(\"Access Token guardado en {{access_token}}.\");",
              "  }",
              "}"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Authorization",
            "value": "Basic oY3jhNDORE62o2zPnwnW:l6uCn7Ll96lyot4T6aqQ3VLlq",
            "type": "text"
          },
          {
            "key": "Content-Type",
            "value": "multipart/form-data",
            "type": "text"
          }
        ],
        "body": {
          "mode": "formdata",
          "formdata": [
            {
              "key": "grant_type",
              "value": "client_credentials",
              "type": "text"
            }
          ]
        },
        "url": {
          "raw": "https://wsbeta.fedex.com/LAC/ServicesAPI/oauth/token",
          "protocol": "https",
          "host": ["wsbeta", "fedex", "com"],
          "path": ["LAC", "ServicesAPI", "oauth", "token"]
        }
      },
      "response": []
    },
    {
      "name": "Create Shipment",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "// Extraer masterTrackingNumber y guardarlo en variable",
              "if (pm.response.code === 200) {",
              "  var jsonData = pm.response.json();",
              "  var master = jsonData.masterTrackingNumber || (jsonData.master && jsonData.master.trackingNumber);",
              "  if (master) {",
              "    pm.collectionVariables.set(\"masterTrackingNumber\", master);",
              "    console.log(\"masterTrackingNumber guardado en {{masterTrackingNumber}}: \" + master);",
              "  } else {",
              "    console.warn(\"No se encontró masterTrackingNumber en la respuesta.\");",
              "  }",
              "}"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{access_token}}",
            "type": "text"
          },
          {
            "key": "Content-Type",
            "value": "application/json",
            "type": "text"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"credential\": {\n    \"accountNumber\": \"615612898\",\n    \"meterNumber\": \"256549685\",\n    \"wskeyUserCredential\": \"ICA5VOTfC6F74Dlt\",\n    \"wspasswordUserCredential\": \"5woctSZ7SjTeV7gBPVPgHZklu\"\n  },\n  \"shipper\": {\n    \"contact\": {\n      \"personName\": \"Sils Group\",\n      \"phoneNumber\": \"+56931987281\",\n      \"companyName\": \"Sils Group\",\n      \"email\": \"contacto@sils.group\",\n      \"vatNumber\": \"77057527-3\"\n    },\n    \"address\": {\n      \"city\": \"Pudahuel\",\n      \"stateOrProvinceCode\": \"CL\",\n      \"postalCode\": \"9020000\",\n      \"countryCode\": \"CL\",\n      \"residential\": false,\n      \"streetLine1\": \"Puerto Santiago 259\"\n    }\n  },\n  \"recipient\": {\n    \"contact\": {\n      \"personName\": \"Carlos Jordan\",\n      \"phoneNumber\": \"+56959495349\",\n      \"companyName\": \"Amo mi Negocio\",\n      \"email\": \"contacto@amominegocio.cl\",\n      \"vatNumber\": \"77639373-8\"\n    },\n    \"address\": {\n      \"city\": \"La Florida\",\n      \"stateOrProvinceCode\": \"CL\",\n      \"postalCode\": \"8240000\",\n      \"countryCode\": \"CL\",\n      \"residential\": false,\n      \"streetLine1\": \"Las Acacias 7800\"\n    }\n  },\n  \"shipDate\": \"08/28/2025\",\n  \"serviceType\": \"FEDEX_PRIORITY\",\n  \"packagingType\": \"YOUR_PACKAGING\",\n  \"shippingChargesPayment\": {\n    \"paymentType\": \"SENDER\",\n    \"accountNumber\": \"615612898\"\n  },\n  \"labelType\": \"ONLY_DATA\",\n  \"requestedPackageLineItems\": [\n    {\n      \"itemDescription\": \"82850194-89994- 1/1\",\n      \"weight\": {\n        \"value\": 1,\n        \"units\": \"KG\"\n      },\n      \"dimensions\": {\n        \"length\": 1,\n        \"width\": 1,\n        \"height\": 1,\n        \"units\": \"CM\"\n      }\n    },\n    {\n      \"itemDescription\": \"82850222-90022- 1/1\",\n      \"weight\": {\n        \"value\": 1,\n        \"units\": \"KG\"\n      },\n      \"dimensions\": {\n        \"length\": 1,\n        \"width\": 1,\n        \"height\": 1,\n        \"units\": \"CM\"\n      }\n    }\n  ],\n  \"specialServicesRequested\": {\n    \"specialServiceTypes\": [\"RETURN_DOCUMENTS\"],\n    \"documentsToReturn\": [\n      {\n        \"docType\": \"CI\",\n        \"docId\": \"89994\"\n      }\n    ],\n    \"customerDocsReference\": \"89994\"\n  },\n  \"clearanceDetail\": {\n    \"documentContent\": \"NON_DOCUMENT\",\n    \"commodities\": [\n      {\n        \"description\": \"some packs\",\n        \"countryOfManufacture\": \"CL\",\n        \"numberOfPieces\": 1,\n        \"weight\": {\n          \"value\": 0.0,\n          \"units\": \"KG\"\n        },\n        \"quantity\": 0,\n        \"quantityUnits\": \"PCS\",\n        \"unitPrice\": {\n          \"amount\": 0.0,\n          \"currency\": \"CHP\"\n        }\n      }\n    ]\n  },\n  \"references\": [\n    {\"customerReferenceType\": \"CUSTOMER_REFERENCE\", \"value\": \"89994\"},\n    {\"customerReferenceType\": \"PURCHACE_ORDER\", \"value\": \"82850194\"},\n    {\"customerReferenceType\": \"INVOICE\", \"value\": \"89994\"}\n  ],\n  \"insuranceValue\": {\"amount\": 1146264, \"currency\": \"CHP\"}\n}"
        },
        "url": {
          "raw": "https://wsbeta.fedex.com/LAC/ServicesAPI/cdrm/api/createShipment",
          "protocol": "https",
          "host": ["wsbeta", "fedex", "com"],
          "path": ["LAC", "ServicesAPI", "cdrm", "api", "createShipment"]
        }
      },
      "response": []
    },
    {
      "name": "Cancel Shipment",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{access_token}}",
            "type": "text"
          },
          {
            "key": "Content-Type",
            "value": "application/json",
            "type": "text"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"credential\": {\n    \"accountNumber\": \"615612898\",\n    \"meterNumber\": \"256549685\",\n    \"wskeyUserCredential\": \"ICA5VOTfC6F74Dlt\",\n    \"wspasswordUserCredential\": \"5woctSZ7SjTeV7gBPVPgHZklu\"\n  },\n  \"masterTrackingNumber\": \"{{masterTrackingNumber}}\"\n}"
        },
        "url": {
          "raw": "https://wsbeta.fedex.com/LAC/ServicesAPI/cdrm/api/cancelShipment",
          "protocol": "https",
          "host": ["wsbeta", "fedex", "com"],
          "path": ["LAC", "ServicesAPI", "cdrm", "api", "cancelShipment"]
        }
      },
      "response": []
    }
  ]
}
